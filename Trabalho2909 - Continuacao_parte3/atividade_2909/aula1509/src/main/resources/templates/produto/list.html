<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pt-br"
      th:replace="~{layout :: layout(~{::head}, ~{::main})}">

<head th:replace="~{fragments/head :: head('Lista de Produtos')}"></head>

<main class="flex-grow-1">
    <div class="container my-4">

        <div class="card shadow-lg border-0">

            <div class="card-header bg-primary text-white text-center py-3">
                <h2 class="mb-0">
                    <i class="bi bi-box-seam me-2"></i>Lista de Produtos
                </h2>
            </div>

            <div class="card-body">

                <div class="d-flex justify-content-center flex-wrap gap-2 mb-4">
                    <a th:href="@{/produto/form}" class="btn btn-success">
                        <i class="bi bi-plus-circle me-2"></i>Cadastrar Novo Produto
                    </a>
                </div>

                <form th:action="@{/produto/list}" method="get" class="mb-4">
                    <div class="input-group">
                        <input type="text"
                               name="filtro"
                               th:value="${filtro}"
                               class="form-control"
                               placeholder="Buscar por nome do produto">

                        <button class="btn btn-primary" type="submit">
                            <i class="bi bi-search"></i> Buscar
                        </button>

                        <a th:href="@{/produto/list}" class="btn btn-secondary">
                            <i class="bi bi-x-circle"></i> Limpar
                        </a>
                    </div>
                </form>

                <div class="table-responsive">
                    <table class="table table-hover align-middle text-center mb-0">
                        <thead class="table-primary">
                        <tr>
                            <th>ID</th>
                            <th>Descrição</th>
                            <th>Valor (R$)</th>
                            <th colspan="3">Ações</th>
                        </tr>
                        </thead>

                        <tbody>
                        <tr th:each="p : ${produtos}">
                            <td th:text="${p.id}"></td>
                            <td th:text="${p.descricao}"></td>
                            <td>
                                R$
                                <span th:text="${#numbers.formatDecimal(p.valor, 2, 'POINT', 2, 'COMMA')}"></span>
                            </td>

                            <td>
                                <a th:href="@{/produto/editar/{id}(id=${p.id})}"
                                   class="btn btn-warning btn-sm text-dark">
                                    <i class="bi bi-pencil-square me-1"></i>Editar
                                </a>
                            </td>

                            <td>
                                <a th:href="@{/produto/remover/{id}(id=${p.id})}"
                                   class="btn btn-danger btn-sm"
                                   onclick="return confirm('Tem certeza que deseja excluir este produto?')">
                                    <i class="bi bi-trash me-1"></i>Excluir
                                </a>
                            </td>
                        </tr>

                        <tr th:if="${#lists.isEmpty(produtos)}">
                            <td colspan="5" class="text-muted fst-italic">
                                Nenhum produto cadastrado.
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</main>
</html>
