<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/Trabalho2909 - Continuacao_parte3/atividade_2909/aula1509/src/main/java/pweb/aula2909/controller/VendaController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/Trabalho2909 - Continuacao_parte3/atividade_2909/aula1509/src/main/java/pweb/aula2909/controller/VendaController.java" />
              <option name="originalContent" value="package pweb.aula2909.controller;&#10;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.stereotype.Controller;&#10;import org.springframework.ui.ModelMap;&#10;import org.springframework.web.bind.annotation.*;&#10;import org.springframework.web.servlet.ModelAndView;&#10;import pweb.aula2909.model.entity.Venda;&#10;import pweb.aula2909.model.repository.VendaRepository;&#10;import pweb.aula2909.model.repository.PessoaFisicaRepository;&#10;import pweb.aula2909.model.repository.PessoaJuridicaRepository;&#10;import java.time.LocalDate;&#10;import java.time.LocalDateTime;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;&#10;@Controller&#10;@RequestMapping(&quot;/venda&quot;)&#10;public class VendaController {&#10;&#10;    @Autowired&#10;    private VendaRepository repository;&#10;&#10;    @Autowired&#10;    private PessoaFisicaRepository pessoaFisicaRepo;&#10;&#10;    @Autowired&#10;    private PessoaJuridicaRepository pessoaJuridicaRepo;&#10;&#10;    private LocalDateTime[] intervaloDia(String inicioData, String fimData) {&#10;        LocalDate dtInicio;&#10;        LocalDate dtFim;&#10;&#10;        if (inicioData != null &amp;&amp; !inicioData.isEmpty()) {&#10;            dtInicio = LocalDate.parse(inicioData);&#10;        } else if (fimData != null &amp;&amp; !fimData.isEmpty()) {&#10;            dtInicio = LocalDate.parse(fimData);&#10;        } else {&#10;            dtInicio = LocalDate.of(1, 1, 1);&#10;        }&#10;&#10;        if (fimData != null &amp;&amp; !fimData.isEmpty()) {&#10;            dtFim = LocalDate.parse(fimData);&#10;        } else if (inicioData != null &amp;&amp; !inicioData.isEmpty()) {&#10;            dtFim = LocalDate.parse(inicioData);&#10;        } else {&#10;            dtFim = LocalDate.now();&#10;        }&#10;&#10;        return new LocalDateTime[]{&#10;                dtInicio.atTime(0,0,0),&#10;                dtFim.atTime(23, 59, 59)&#10;        };&#10;    }&#10;&#10;&#10;    private List&lt;Object&gt; carregarClientes() {&#10;        List&lt;Object&gt; clientes = new ArrayList&lt;&gt;();&#10;        clientes.addAll(pessoaFisicaRepo.pessoasFisicas());&#10;        clientes.addAll(pessoaJuridicaRepo.pessoasJuridicas());&#10;        return clientes;&#10;    }&#10;&#10;&#10;    @GetMapping(&quot;/list&quot;)&#10;    public ModelAndView listar(@RequestParam(required = false) Long clienteId, @RequestParam(required = false) String dataInicio, @RequestParam(required = false) String dataFim, ModelMap model) {&#10;&#10;        List&lt;Venda&gt; vendas;&#10;&#10;        model.addAttribute(&quot;clientes&quot;, carregarClientes());&#10;&#10;        boolean temCliente = clienteId != null;&#10;        boolean temData = ( (dataInicio != null &amp;&amp; !dataInicio.isEmpty()) || (dataFim != null &amp;&amp; !dataFim.isEmpty()) );&#10;&#10;        if (temCliente &amp;&amp; temData) {&#10;            LocalDateTime[] intervalo = intervaloDia(dataInicio, dataFim);&#10;            vendas = repository.listarPorClienteEData(clienteId, intervalo[0], intervalo[1]);&#10;            model.addAttribute(&quot;clienteFiltro&quot;, clienteId);&#10;            model.addAttribute(&quot;dataInicioFiltro&quot;, dataInicio);&#10;            model.addAttribute(&quot;dataFimFiltro&quot;, dataFim);&#10;&#10;        } else if (temCliente) {&#10;            vendas = repository.listarPorCliente(clienteId);&#10;            model.addAttribute(&quot;clienteFiltro&quot;, clienteId);&#10;&#10;        } else if (temData) {&#10;&#10;            LocalDateTime[] intervalo = intervaloDia(dataInicio, dataFim);&#10;            vendas = repository.listarPorData(intervalo[0], intervalo[1]);&#10;            model.addAttribute(&quot;dataInicioFiltro&quot;, dataInicio);&#10;            model.addAttribute(&quot;dataFimFiltro&quot;, dataFim);&#10;&#10;        } else {&#10;            vendas = repository.listar();&#10;        }&#10;&#10;        model.addAttribute(&quot;vendas&quot;, vendas);&#10;&#10;        return new ModelAndView(&quot;/venda/list&quot;, model);&#10;    }&#10;&#10;    @GetMapping(&quot;/detail/{id}&quot;)&#10;    public ModelAndView detalhes(@PathVariable(&quot;id&quot;) Long id, ModelMap model) {&#10;        Venda venda = repository.buscarPorId(id);&#10;&#10;        if (venda != null) {&#10;            model.addAttribute(&quot;venda&quot;, venda);&#10;        }&#10;&#10;        return new ModelAndView(&quot;/venda/detail&quot;, model);&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package pweb.aula2909.controller;&#10;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.stereotype.Controller;&#10;import org.springframework.ui.ModelMap;&#10;import org.springframework.web.bind.annotation.*;&#10;import org.springframework.web.servlet.ModelAndView;&#10;import pweb.aula2909.model.entity.Venda;&#10;import pweb.aula2909.model.repository.VendaRepository;&#10;import pweb.aula2909.model.repository.PessoaFisicaRepository;&#10;import pweb.aula2909.model.repository.PessoaJuridicaRepository;&#10;import java.time.LocalDate;&#10;import java.time.LocalDateTime;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;&#10;@Controller&#10;@RequestMapping(&quot;/venda&quot;)&#10;public class VendaController {&#10;&#10;    @Autowired&#10;    private VendaRepository repository;&#10;&#10;    @Autowired&#10;    private PessoaFisicaRepository pessoaFisicaRepo;&#10;&#10;    @Autowired&#10;    private PessoaJuridicaRepository pessoaJuridicaRepo;&#10;&#10;    private LocalDateTime[] intervaloDia(String inicioData, String fimData) {&#10;        LocalDate dtInicio;&#10;        LocalDate dtFim;&#10;&#10;        if (inicioData != null &amp;&amp; !inicioData.isEmpty()) {&#10;            dtInicio = LocalDate.parse(inicioData);&#10;        } else if (fimData != null &amp;&amp; !fimData.isEmpty()) {&#10;            dtInicio = LocalDate.parse(fimData);&#10;        } else {&#10;            dtInicio = LocalDate.of(1, 1, 1);&#10;        }&#10;&#10;        if (fimData != null &amp;&amp; !fimData.isEmpty()) {&#10;            dtFim = LocalDate.parse(fimData);&#10;        } else if (inicioData != null &amp;&amp; !inicioData.isEmpty()) {&#10;            dtFim = LocalDate.parse(inicioData);&#10;        } else {&#10;            dtFim = LocalDate.now();&#10;        }&#10;&#10;        return new LocalDateTime[]{&#10;                dtInicio.atTime(0,0,0),&#10;                dtFim.atTime(23, 59, 59)&#10;        };&#10;    }&#10;&#10;&#10;    private List&lt;Object&gt; carregarClientes() {&#10;        List&lt;Object&gt; clientes = new ArrayList&lt;&gt;();&#10;        clientes.addAll(pessoaFisicaRepo.pessoasFisicas());&#10;        clientes.addAll(pessoaJuridicaRepo.pessoasJuridicas());&#10;        return clientes;&#10;    }&#10;&#10;&#10;    @GetMapping(&quot;/list&quot;)&#10;    public ModelAndView listar(@RequestParam(required = false) Long clienteId, @RequestParam(required = false) String dataInicio, @RequestParam(required = false) String dataFim, ModelMap model) {&#10;&#10;        List&lt;Venda&gt; vendas;&#10;&#10;        model.addAttribute(&quot;clientes&quot;, carregarClientes());&#10;&#10;        boolean temCliente = clienteId != null;&#10;        boolean temData = ( (dataInicio != null &amp;&amp; !dataInicio.isEmpty()) || (dataFim != null &amp;&amp; !dataFim.isEmpty()) );&#10;&#10;        if (temCliente &amp;&amp; temData) {&#10;            LocalDateTime[] intervalo = intervaloDia(dataInicio, dataFim);&#10;            vendas = repository.listarPorClienteEData(clienteId, intervalo[0], intervalo[1]);&#10;            model.addAttribute(&quot;clienteFiltro&quot;, clienteId);&#10;            model.addAttribute(&quot;dataInicioFiltro&quot;, dataInicio);&#10;            model.addAttribute(&quot;dataFimFiltro&quot;, dataFim);&#10;&#10;        } else if (temCliente) {&#10;            vendas = repository.listarPorCliente(clienteId);&#10;            model.addAttribute(&quot;clienteFiltro&quot;, clienteId);&#10;&#10;        } else if (temData) {&#10;&#10;            LocalDateTime[] intervalo = intervaloDia(dataInicio, dataFim);&#10;            vendas = repository.listarPorData(intervalo[0], intervalo[1]);&#10;            model.addAttribute(&quot;dataInicioFiltro&quot;, dataInicio);&#10;            model.addAttribute(&quot;dataFimFiltro&quot;, dataFim);&#10;&#10;        } else {&#10;            vendas = repository.listar();&#10;        }&#10;&#10;        model.addAttribute(&quot;vendas&quot;, vendas);&#10;&#10;        return new ModelAndView(&quot;/venda/list&quot;, model);&#10;    }&#10;&#10;    @GetMapping(&quot;/detail/{id}&quot;)&#10;    public ModelAndView detalhes(@PathVariable(&quot;id&quot;) Long id, ModelMap model) {&#10;        Venda venda = repository.buscarPorId(id);&#10;&#10;        if (venda != null) {&#10;            model.addAttribute(&quot;venda&quot;, venda);&#10;        }&#10;&#10;        return new ModelAndView(&quot;/venda/detail&quot;, model);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/Trabalho2909 - Continuacao_parte3/atividade_2909/aula1509/src/main/resources/templates/fragments/header.html">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/Trabalho2909 - Continuacao_parte3/atividade_2909/aula1509/src/main/resources/templates/fragments/header.html" />
              <option name="originalContent" value="&lt;header th:fragment=&quot;header&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;&#10;    &lt;nav class=&quot;navbar navbar-expand-lg navbar-dark bg-primary mb-4&quot;&gt;&#10;        &lt;div class=&quot;container-fluid&quot;&gt;&#10;            &lt;a class=&quot;navbar-brand fw-bold&quot; th:href=&quot;@{/}&quot;&gt;Cadastro Web II&lt;/a&gt;&#10;            &lt;button class=&quot;navbar-toggler&quot; type=&quot;button&quot; data-bs-toggle=&quot;collapse&quot;&#10;                    data-bs-target=&quot;#navbarNav&quot; aria-controls=&quot;navbarNav&quot;&#10;                    aria-expanded=&quot;false&quot; aria-label=&quot;Alternar navegação&quot;&gt;&#10;                &lt;span class=&quot;navbar-toggler-icon&quot;&gt;&lt;/span&gt;&#10;            &lt;/button&gt;&#10;&#10;            &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;navbarNav&quot;&gt;&#10;                &lt;ul class=&quot;navbar-nav me-auto mb-2 mb-lg-0&quot;&gt;&#10;                    &lt;li class=&quot;nav-item fw-bold&quot;&gt;&lt;a class=&quot;nav-link&quot; th:href=&quot;@{/pessoafisica/list}&quot;&gt;Pessoas Físicas&lt;/a&gt;&lt;/li&gt;&#10;                    &lt;li class=&quot;nav-item fw-bold&quot;&gt;&lt;a class=&quot;nav-link&quot; th:href=&quot;@{/pessoajuridica/list}&quot;&gt;Pessoas Jurídicas&lt;/a&gt;&lt;/li&gt;&#10;&#10;                    &lt;!-- Dropdown de produtos: link para 'Todos' e uma lista rápida de produtos dinamicamente carregada --&gt;&#10;                    &lt;li class=&quot;nav-item dropdown fw-bold&quot;&gt;&#10;                        &lt;a class=&quot;nav-link dropdown-toggle&quot; href=&quot;#&quot; id=&quot;produtosDropdown&quot; role=&quot;button&quot; data-bs-toggle=&quot;dropdown&quot; aria-expanded=&quot;false&quot;&gt;&#10;                            Produtos&#10;                        &lt;/a&gt;&#10;                        &lt;ul class=&quot;dropdown-menu&quot; aria-labelledby=&quot;produtosDropdown&quot;&gt;&#10;                            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; th:href=&quot;@{/produto/list}&quot;&gt;Lista de Produtos Cadastrados&lt;/a&gt;&lt;/li&gt;&#10;                            &lt;li&gt;&lt;hr class=&quot;dropdown-divider&quot;&gt;&lt;/li&gt;&#10;&#10;                            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; th:href=&quot;@{/produto/list-venda}&quot;&gt;Produtos para Venda&lt;/a&gt;&lt;/li&gt;&#10;                            &lt;li&gt;&lt;hr class=&quot;dropdown-divider&quot;&gt;&lt;/li&gt;&#10;&#10;                        &lt;/ul&gt;&#10;                    &lt;/li&gt;&#10;&#10;                    &lt;li class=&quot;nav-item fw-bold&quot;&gt;&lt;a class=&quot;nav-link&quot; th:href=&quot;@{/venda/list}&quot;&gt;Vendas&lt;/a&gt;&lt;/li&gt;&#10;                &lt;/ul&gt;&#10;            &lt;/div&gt;&#10;        &lt;/div&gt;&#10;    &lt;/nav&gt;&#10;&lt;/header&gt;&#10;" />
              <option name="updatedContent" value="&lt;header th:fragment=&quot;header&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;&#13;&#10;    &lt;nav class=&quot;navbar navbar-expand-lg navbar-dark bg-primary mb-4&quot;&gt;&#13;&#10;        &lt;div class=&quot;container-fluid&quot;&gt;&#13;&#10;            &lt;a class=&quot;navbar-brand fw-bold&quot; th:href=&quot;@{/}&quot;&gt;Cadastro Web II&lt;/a&gt;&#13;&#10;            &lt;button class=&quot;navbar-toggler&quot; type=&quot;button&quot; data-bs-toggle=&quot;collapse&quot;&#13;&#10;                    data-bs-target=&quot;#navbarNav&quot; aria-controls=&quot;navbarNav&quot;&#13;&#10;                    aria-expanded=&quot;false&quot; aria-label=&quot;Alternar navegação&quot;&gt;&#13;&#10;                &lt;span class=&quot;navbar-toggler-icon&quot;&gt;&lt;/span&gt;&#13;&#10;            &lt;/button&gt;&#13;&#10;&#13;&#10;            &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;navbarNav&quot;&gt;&#13;&#10;                &lt;ul class=&quot;navbar-nav me-auto mb-2 mb-lg-0&quot;&gt;&#13;&#10;                    &lt;li class=&quot;nav-item fw-bold&quot;&gt;&lt;a class=&quot;nav-link&quot; th:href=&quot;@{/pessoafisica/list}&quot;&gt;Pessoas Físicas&lt;/a&gt;&lt;/li&gt;&#13;&#10;                    &lt;li class=&quot;nav-item fw-bold&quot;&gt;&lt;a class=&quot;nav-link&quot; th:href=&quot;@{/pessoajuridica/list}&quot;&gt;Pessoas Jurídicas&lt;/a&gt;&lt;/li&gt;&#13;&#10;&#13;&#10;                    &lt;!-- Dropdown de produtos: link para 'Todos' e uma lista rápida de produtos dinamicamente carregada --&gt;&#13;&#10;                    &lt;li class=&quot;nav-item dropdown fw-bold&quot;&gt;&#13;&#10;                        &lt;a class=&quot;nav-link dropdown-toggle&quot; href=&quot;#&quot; id=&quot;produtosDropdown&quot; role=&quot;button&quot; data-bs-toggle=&quot;dropdown&quot; aria-expanded=&quot;false&quot;&gt;&#13;&#10;                            Produtos&#13;&#10;                        &lt;/a&gt;&#13;&#10;                        &lt;ul class=&quot;dropdown-menu&quot; aria-labelledby=&quot;produtosDropdown&quot;&gt;&#13;&#10;                            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; th:href=&quot;@{/produto/list}&quot;&gt;Lista de Produtos Cadastrados&lt;/a&gt;&lt;/li&gt;&#13;&#10;                            &lt;li&gt;&lt;hr class=&quot;dropdown-divider&quot;&gt;&lt;/li&gt;&#13;&#10;&#13;&#10;                            &lt;li&gt;&lt;a class=&quot;dropdown-item&quot; th:href=&quot;@{/produto/list-venda}&quot;&gt;Produtos para Venda&lt;/a&gt;&lt;/li&gt;&#13;&#10;                            &lt;li&gt;&lt;hr class=&quot;dropdown-divider&quot;&gt;&lt;/li&gt;&#13;&#10;&#13;&#10;                        &lt;/ul&gt;&#13;&#10;                    &lt;/li&gt;&#13;&#10;&#13;&#10;                    &lt;li class=&quot;nav-item fw-bold&quot;&gt;&lt;a class=&quot;nav-link&quot; th:href=&quot;@{/venda/list}&quot;&gt;Vendas&lt;/a&gt;&lt;/li&gt;&#13;&#10;                &lt;/ul&gt;&#13;&#10;            &lt;/div&gt;&#13;&#10;        &lt;/div&gt;&#13;&#10;    &lt;/nav&gt;&#13;&#10;&lt;/header&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>